<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Frontend.Components.RouteGuard.RouteGuardPage"
             Title="Security Verification"
             BackgroundColor="#1a1a1a">
    
    <Grid VerticalOptions="Center" HorizontalOptions="Center" Padding="20">
        <!-- Main Card -->
        <Border StrokeShape="RoundRectangle 10"
                Stroke="#00e5ff"
                StrokeThickness="1"
                BackgroundColor="#222222"
                WidthRequest="400">
            <Border.Shadow>
                <Shadow Brush="#00e5ff"
                        Offset="0,0"
                        Radius="10"
                        Opacity="0.3" />
            </Border.Shadow>
            
            <VerticalStackLayout Spacing="15" Padding="20">
                <!-- Header -->
                <Label Text="Security Verification Required" 
                       FontSize="22" 
                       TextColor="#00e5ff"
                       FontAttributes="Bold"
                       HorizontalOptions="Center" />
                
                <Label Text="Please enter your unique key to access this module" 
                       FontSize="14" 
                       TextColor="White"
                       HorizontalOptions="Center"
                       Margin="0,0,0,10" />
                
                <!-- Target Module -->
                <Label Text="Target Module:" 
                       FontSize="14" 
                       TextColor="#00e5ff" />
                
                <Label x:Name="ModuleNameLabel" 
                       Text="{Binding TargetModule}" 
                       FontSize="16" 
                       FontAttributes="Bold"
                       TextColor="White"
                       Margin="0,0,0,5" />
                
                <!-- Unique Key -->
                <Label Text="Unique Key:" 
                       FontSize="14" 
                       TextColor="#00e5ff" />
                
                <!-- Unique Key Entry with Toggle Visibility Button inside the field -->
                <Grid Margin="0,0,0,5">
                    <Border StrokeShape="RoundRectangle 4"
                            Stroke="#333333"
                            StrokeThickness="1"
                            BackgroundColor="#333333">
                        <Grid ColumnDefinitions="*, Auto">
                            <Entry x:Name="UniqueKeyEntry" 
                                  IsPassword="{Binding IsPasswordHidden}"
                                  Placeholder="Enter your unique key"
                                  TextColor="White"
                                  BackgroundColor="Transparent"
                                  PlaceholderColor="LightGray"
                                  Margin="5,0,0,0" />
                            
                            <Button Grid.Column="1"
                                    x:Name="TogglePasswordButton"
                                    BackgroundColor="Transparent"
                                    Clicked="OnTogglePasswordVisibility"
                                    WidthRequest="40"
                                    HeightRequest="40"
                                    Padding="0"
                                    Margin="0">
                                <Button.ImageSource>
                                    <FontImageSource FontFamily="MaterialIcons"
                                                    Glyph="{Binding TogglePasswordIcon}"
                                                    Color="#00e5ff"
                                                    Size="20" />
                                </Button.ImageSource>
                            </Button>
                        </Grid>
                    </Border>
                </Grid>
                
                <!-- Error Message -->
                <Label x:Name="ErrorMessageLabel" 
                       Text="{Binding ErrorMessage}" 
                       TextColor="Red" 
                       IsVisible="{Binding HasError}"
                       FontSize="14" />
                
                <!-- Buttons -->
                <Grid ColumnDefinitions="*,*" ColumnSpacing="15" Margin="0,10,0,0">
                    <Button Text="Cancel" 
                            BackgroundColor="#333333" 
                            TextColor="White" 
                            CornerRadius="5"
                            Clicked="OnCancelClicked" />
                    
                    <Grid Grid.Column="1">
                        <!-- Verify Button -->
                        <Button Text="Verify" 
                                BackgroundColor="#00e5ff" 
                                TextColor="Black" 
                                CornerRadius="5"
                                Clicked="OnVerifyClicked"
                                IsVisible="{Binding IsNotBusy}" />
                        
                        <!-- Loading Indicator -->
                        <ActivityIndicator IsRunning="{Binding IsBusy}"
                                          IsVisible="{Binding IsBusy}"
                                          Color="#00e5ff"
                                          HorizontalOptions="Center"
                                          VerticalOptions="Center" />
                    </Grid>
                </Grid>
            </VerticalStackLayout>
        </Border>
    </Grid>
</ContentPage> 